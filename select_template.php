<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï CV 1 ‡∏´‡∏ô‡πâ‡∏≤ A4 (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î Template 3)</title>

    <script>
        const USER_CV_DATA = {
            'profile_img': 'https://via.placeholder.com/250x250?text=Photo', // URL ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
            'name_th': '‡∏ì‡∏±‡∏ê‡∏û‡∏á‡∏®‡πå ‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏ó‡∏∞',
            'job_title': '‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤ Web Application ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢',
            'email': 'sasiwimont65@nu.ac.th',
            'phone': '095-306-9514',
            'address': '7/1 ‡∏´‡∏°‡∏π‡πà 3 ‡∏ï. ‡∏ß‡∏≤‡πÇ‡∏Å‡πâ ‡∏à.‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢',
            'portfolio_link': 'https://github.com/Natthaphong-S', 
            'summary': '‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ 4 ‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ Full-Stack ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÉ‡∏´‡∏°‡πà‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á',
            
            'edu_high_school': '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤',
            'edu_high_school_plan': '‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï',
            'edu_high_school_gpa': '3.45',
            'edu_university': '‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÅ‡∏°‡πà‡∏ü‡πâ‡∏≤‡∏´‡∏•‡∏ß‡∏á',
            'edu_degree': '‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ (‡∏ß‡∏®.‡∏ö.)',
            'edu_faculty': '‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®',
            'edu_major': '‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
            'edu_graduation_year': '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏° 2568',
            'edu_university_gpa': '3.85 (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)',

            'work_experience': [{ title: '‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏≤‡∏ô IoT ‡πÅ‡∏•‡∏∞ Web Development', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î', duration: '‡∏°‡∏µ.‡∏Ñ. 2567 - ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô', details: '‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå IoT ‡∏î‡πâ‡∏ß‡∏¢ ESP32 ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Dashboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö Real-time ‡∏î‡πâ‡∏ß‡∏¢ ReactJS' }],
            'technical_skills': ['Java', 'C#', 'Python', 'HTML/CSS', 'JavaScript (ReactJS)', 'PHP (Laravel)', 'SQL', 'GNS3', 'Cisco Networking'],
            'soft_skills': ['‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡∏°', '‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û', '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏•‡∏≤', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß'],
            'projects': [ { name: '‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å (Web Application)', details: '‡∏û‡∏±‡∏í‡∏ô‡∏≤ Backend ‡∏î‡πâ‡∏ß‡∏¢ PHP ‡πÅ‡∏•‡∏∞ MySQL' }, { name: 'Network and Firewall Simulation Project', details: '‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏°‡∏≤‡πÉ‡∏ä‡πâ' } ],
            'reference': '‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå ‡∏î‡∏£. ‡∏ä‡∏¢‡∏û‡∏• ‡∏Ñ‡∏≥‡∏õ‡πà‡∏≠‡∏¢ (chayapol.k@mfu.ac.th)'
        };
    </script>

    <style>
        /* Define New Color Palette (Modern & Professional) */
        :root {
            --color-primary: #00796B;   /* Teal/Dark Cyan - Accent Color */
            --color-secondary: #263238; /* Charcoal/Dark Blue - Main Text/Headers */
            --color-light-bg: #F4F6F7;  /* Very Light Grey/Off-White - Background for sidebars/boxes */
            --color-text: #37474F;      /* Dark Grey - Body Text */
            --color-border: #CFD8DC;    /* Light Border */
        }
        
        /* General Styles */
        body { font-family: 'Sukhumvit Set', 'Arial', sans-serif; background-color: #f4f4f9; color: var(--color-text); margin: 0; padding: 20px; text-align: center; }
        .template-container { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; }
        .template-card { background-color: #fff; border-radius: 12px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); padding: 25px; width: 320px; text-align: left; border-top: 5px solid var(--color-primary); }
        .btn-preview { background-color: #6c757d; color: white; margin-bottom: 5px; padding: 10px; width: 100%; border: none; border-radius: 4px;}
        .btn-select { background-color: var(--color-primary); color: white; padding: 10px; width: 100%; border: none; border-radius: 4px;}
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8); }
        .modal-content { background-color: #fefefe; margin: 2% auto; padding: 20px; border-radius: 8px; width: 90%; max-width: 1100px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); }
        .close-btn { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
        .close-btn:hover, .close-btn:focus { color: #000; text-decoration: none; cursor: pointer; }

        /* --- KEY: A4 SIMULATION (Global) --- */
        #cvPreviewArea {
            width: 794px; 
            height: 1123px; 
            margin: 20px auto;
            padding: 35px; 
            background-color: white;
            border: 1px solid var(--color-border);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            font-size: 11pt; /* Base font for 1 & 2 */
            line-height: 1.5; 
            text-align: left;
            box-sizing: border-box;
        }
        
        /* Shared Styles for CV Sections */
        .cv-section h4 {
            font-size: 1.25em; 
            font-weight: bold;
            margin-top: 25px; 
            margin-bottom: 8px;
            padding-bottom: 2px;
        }
        .detail-item {
            margin-bottom: 15px; 
            line-height: 1.4;
        }
        .detail-item strong {
            display: block;
            font-size: 1.1em; 
        }
        
        /* Icon Styling */
        .contact-info-item {
            display: flex;
            align-items: flex-start;
            font-size: 1em;
            margin-bottom: 6px; 
        }
        .icon {
            margin-right: 8px;
            font-size: 1.1em;
            width: 20px;
            text-align: center;
            color: var(--color-primary); 
        }
        
        /* --- 1. MODERN-SIDEBAR STYLES --- */
        .cv-modern-sidebar { display: flex; height: 100%; }
        .cv-modern-sidebar .cv-sidebar {
            width: 33%; background-color: var(--color-secondary); color: white;
            padding: 10px 15px 15px 15px; box-sizing: border-box; font-size: 1em; line-height: 1.4;
        }
        .cv-modern-sidebar .cv-main-content { width: 67%; padding: 0 20px; box-sizing: border-box; }
        .cv-modern-sidebar h1 { color: var(--color-secondary); font-size: 2.8em; margin-bottom: 5px; }
        .cv-modern-sidebar h2 { color: var(--color-text); border-bottom: 2px solid var(--color-border); padding-bottom: 5px; margin-top: 0; }
        .cv-modern-sidebar .cv-sidebar h4 { color: var(--color-primary); border-bottom: 1px solid var(--color-primary); margin-top: 20px; font-size: 1.15em; }
        .cv-modern-sidebar .cv-main-content h4 { color: var(--color-secondary); border-bottom: 1px solid var(--color-primary); }
        .cv-modern-sidebar .profile-photo { 
            width: 78px; height: 104px; border-radius: 5px; margin: 10px auto 10px auto; 
            display: block; border: 3px solid var(--color-primary); background-size: cover; background-position: center;
        }
        .cv-modern-sidebar .cv-sidebar a { color: var(--color-primary); }

        /* --- 2. PROFESSIONAL-HYBRID STYLES --- */
        .cv-professional-hybrid { height: 100%; display: flex; flex-direction: column; }
        .cv-professional-hybrid .header { border-bottom: 3px solid var(--color-primary); padding-bottom: 8px; margin-bottom: 20px; }
        .cv-professional-hybrid h1 { color: var(--color-secondary); font-size: 3em; margin: 0; text-align: left; }
        .cv-professional-hybrid h2 { color: var(--color-primary); font-size: 1.5em; margin: 0; text-align: left; }
        .cv-professional-hybrid .summary-box { margin-bottom: 20px; padding: 0 0 10px 0; font-style: italic; border-bottom: 1px dashed var(--color-border); }
        .cv-professional-hybrid .main-cols { display: flex; gap: 30px; height: 100%; }
        .cv-professional-hybrid .left-col { width: 68%; padding-right: 15px; }
        .cv-professional-hybrid .right-col { width: 32%; background-color: var(--color-light-bg); padding: 15px; border-radius: 5px; }
        .cv-professional-hybrid h4 { color: var(--color-secondary); border-bottom: 1px solid var(--color-border); margin-top: 20px; padding-bottom: 3px; font-size: 1.2em; }
        .cv-professional-hybrid .right-col h4 { color: var(--color-primary); }
        .skill-tag { display:inline-block; background-color:var(--color-border); padding: 4px 8px; margin: 4px 4px 4px 0; border-radius: 4px; font-size: 0.95em;}

        /* --- 3. MINIMALIST-FOCUS STYLES --- */
        .cv-minimalist-focus { height: 100%; padding: 0 30px; font-size: 10.5pt; line-height: 1.4; } /* Smaller base font for template 3 */
        .cv-minimalist-focus .header { text-align: center; padding-bottom: 10px; border-bottom: 2px solid var(--color-primary); }
        .cv-minimalist-focus h1 { font-size: 2.8em; color: var(--color-secondary); margin-bottom: 3px; }
        .cv-minimalist-focus h2 { font-size: 1.3em; color: var(--color-primary); margin: 0; }
        .cv-minimalist-focus h4 { color: var(--color-secondary); border-bottom: 1px solid var(--color-primary); margin-top: 25px; padding-bottom: 3px; font-size: 1.15em; }
        .cv-minimalist-focus .footer-contact { margin-top: 25px; padding-top: 8px; border-top: 1px solid var(--color-border); text-align: center; }
        .cv-minimalist-focus .footer-contact span, .cv-minimalist-focus .footer-contact p { font-size: 0.95em;}
    </style>
</head>
<body>

    <header>
        <h1>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏ã‡∏π‡πÄ‡∏°‡πà (CV)</h1>
        <p>‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÉ‡∏à **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡πÄ‡∏ï‡πá‡∏° 1 ‡∏´‡∏ô‡πâ‡∏≤ A4**</p>
    </header>
    
    <hr>

    <div class="template-container">
        
        <div class="template-card" data-template-id="modern-sidebar">
            <h3>1. ‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢-‡πÅ‡∏ñ‡∏ö‡∏Ç‡πâ‡∏≤‡∏á (33:67) üü¢ (‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î/‡∏ï‡∏µ‡∏°‡∏™‡∏µ)</h3>
            <p class="description">**‡∏ï‡∏µ‡∏°‡πÉ‡∏´‡∏°‡πà:** ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏°/‡∏ü‡πâ‡∏≤‡∏Ñ‡∏£‡∏≤‡∏°</p>
            <button class="btn btn-preview" data-template="modern-sidebar">‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô (A4)</button>
            <button class="btn btn-select" data-template="modern-sidebar">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
        </div>

        <div class="template-card" data-template-id="professional-hybrid">
            <h3>2. ‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û-‡∏ú‡∏™‡∏° (68:32) üåü (‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î/‡∏ï‡∏µ‡∏°‡∏™‡∏µ)</h3>
            <p class="description">**‡∏ï‡∏µ‡∏°‡πÉ‡∏´‡∏°‡πà:** ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á ‡∏ä‡∏∑‡πà‡∏≠/‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
            <button class="btn btn-preview" data-template="professional-hybrid">‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô (A4)</button>
            <button class="btn btn-select" data-template="professional-hybrid">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
        </div>
        
        <div class="template-card" data-template-id="minimalist-focus">
            <h3>3. ‡∏°‡∏¥‡∏ô‡∏¥‡∏°‡∏≠‡∏•-‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (100%) ‚ú® (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏±‡πä‡∏Å‡πÅ‡∏•‡πâ‡∏ß)</h3>
            <p class="description">**‡∏ï‡∏µ‡∏°‡πÉ‡∏´‡∏°‡πà:** ‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ï‡∏≤ ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏Ñ‡∏£‡∏≤‡∏°/‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</p>
            <button class="btn btn-preview" data-template="minimalist-focus">‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô (A4)</button>
            <button class="btn btn-select" data-template="minimalist-focus">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
        </div>

    </div>
    
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏ã‡∏π‡πÄ‡∏°‡πà (‡∏Ç‡∏ô‡∏≤‡∏î A4)</h2>
            <div id="cvPreviewArea">
                </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const previewButtons = document.querySelectorAll('.btn-preview');
            const selectButtons = document.querySelectorAll('.btn-select');
            const modal = document.getElementById('previewModal');
            const closeBtn = document.querySelector('.close-btn');
            const cvPreviewArea = document.getElementById('cvPreviewArea');
            const data = USER_CV_DATA; 

            // Helper functions to generate sections
            const renderSkills = (skills) => skills.map(s => `<span class="skill-tag">${s}</span>`).join('');
            
            // --- MAIN FUNCTION: Generate CV HTML (Corrected Scope Issue) ---
            function generateCVHtml(templateId, data) {
                // Initialize styles with default (for Template 1 & 2)
                let detailItemStyle = "margin-bottom: 15px; line-height: 1.4; font-size: 1em;"; 
                let strongStyle = "display: block; font-size: 1.1em;";
                let pStyle = "margin: 0; font-size: 1em;";

                // Override styles for Template 3 (Minimalist-Focus) to ensure smaller text
                if (templateId === 'minimalist-focus') {
                    detailItemStyle = "margin-bottom: 12px; line-height: 1.3; font-size: 0.95em;";
                    strongStyle = "display: block; font-size: 1.05em;";
                    pStyle = "margin: 0; font-size: 0.95em;";
                }

                const experienceHtml = data.work_experience.map(exp => `
                    <div class="detail-item" style="${detailItemStyle}">
                        <strong style="${strongStyle}">${exp.title} - ${exp.company}</strong>
                        <span style="float: right; color: #666; font-size: 0.9em;">${exp.duration}</span>
                        <p style="${pStyle}">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${exp.details}</p>
                    </div>
                `).join('');

                const projectsHtml = data.projects.map(p => `
                    <li><strong>${p.name}</strong>: ${p.details}</li>
                `).join('');
                
                // Content Blocks
                const educationContent = `
                    <div class="detail-item" style="${detailItemStyle}">
                        <strong style="${strongStyle}">‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ${data.edu_university}</strong> 
                        <span style="float: right; color: #666; font-size: 0.9em;">‡∏Ñ‡∏≤‡∏î‡∏à‡∏ö: ${data.edu_graduation_year}</span>
                        <p style="${pStyle}">${data.edu_degree} (${data.edu_major})</p>
                        <p style="margin: 0; font-size: 0.9em;">‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${data.edu_university_gpa}</p>
                    </div>
                    <div class="detail-item" style="${detailItemStyle}">
                        <strong style="${strongStyle}">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤: ${data.edu_high_school}</strong>
                        <p style="${pStyle}">‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${data.edu_high_school_plan}</p>
                        <p style="margin: 0; font-size: 0.9em;">‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${data.edu_high_school_gpa}</p>
                    </div>
                `;
                
                // Contact List with Icons
                const contactContentWithIcons = `
                    <div class="contact-info-item">
                        <span class="icon">&#9993;</span>
                        <p style="margin: 0; line-height: 1.2; overflow-wrap: break-word;">**‡∏≠‡∏µ‡πÄ‡∏°‡∏•:** ${data.email}</p>
                    </div>
                    <div class="contact-info-item">
                        <span class="icon">&#9742;</span>
                        <p style="margin: 0; line-height: 1.2;">**‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:** ${data.phone}</p>
                    </div>
                    <div class="contact-info-item">
                        <span class="icon">&#127969;</span>
                        <p style="margin: 0; line-height: 1.2;">**‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:** ${data.address}</p>
                    </div>
                    <div class="contact-info-item">
                        <span class="icon">&#128187;</span>
                        <p style="margin: 0; line-height: 1.2;">**Github/Portfolio:** <a href="${data.portfolio_link}" style="color: var(--color-primary);">[Link]</a></p>
                    </div>
                `;
                
                // 1. MODERN-SIDEBAR (33:67)
                if (templateId === 'modern-sidebar') {
                    return `
                        <div class="cv-modern-sidebar cv-section">
                            <div class="cv-sidebar">
                                <div class="profile-photo" style="background-image: url('${data.profile_img}');"></div>
                                
                                <h4 style="text-align: center;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h4>
                                <div style="padding: 0 5px; font-size: 1.05em; line-height: 1.4;">
                                    <div style="margin-bottom: 5px;"><span style="color:var(--color-primary);">&#9742;</span> ${data.phone}</div>
                                    <div style="margin-bottom: 5px;"><span style="color:var(--color-primary);">&#9993;</span> ${data.email}</div>
                                    <div style="margin-bottom: 5px;"><span style="color:var(--color-primary);">&#127969;</span> ${data.address}</div>
                                    <div style="margin-bottom: 10px;"><span style="color:var(--color-primary);">&#128187;</span> <a href="${data.portfolio_link}" style="color: var(--color-primary); text-decoration: none;">[Github/Portfolio]</a></div>
                                </div>

                                <h4 style="text-align: center;">Technical Skills</h4>
                                <ul style="list-style: none; padding-left: 10px; font-size: 1.05em;">${data.technical_skills.map(s => `<li>‚Ä¢ ${s}</li>`).join('')}</ul>
                                
                                <h4 style="text-align: center;">Soft Skills</h4>
                                <ul style="list-style: none; padding-left: 10px; font-size: 1.05em;">${data.soft_skills.map(s => `<li>‚Ä¢ ${s}</li>`).join('')}</ul>
                                
                                <h4 style="text-align: center;">‡∏Ñ‡∏≥‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á</h4>
                                <p style="font-size: 1em; text-align: center;">${data.reference}</p>
                            </div>
                            
                            <div class="cv-main-content">
                                <div>
                                    <h1>${data.name_th}</h1>
                                    <h2>${data.job_title}</h2>
                                    
                                    <h4 class="cv-section">‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô (Summary)</h4>
                                    <p style="font-size: 1.05em; line-height: 1.5;">${data.summary}</p>
                                    
                                    <h4 class="cv-section">‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô/‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</h4>
                                    ${experienceHtml}
                                    
                                    <h4 class="cv-section">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h4>
                                    ${educationContent}
                                    
                                    <h4 class="cv-section">‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå/‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h4>
                                    <ul style="font-size: 1em; margin-top: 5px; padding-left: 20px;">
                                        ${projectsHtml}
                                        <li><strong>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°:</strong> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏ä‡∏°‡∏£‡∏°‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå (2565-2567)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                } 
                
                // 2. PROFESSIONAL-HYBRID (68:32)
                else if (templateId === 'professional-hybrid') {
                    return `
                        <div class="cv-professional-hybrid cv-section">
                            <div class="header">
                                <h1>${data.name_th}</h1>
                                <h2>${data.job_title}</h2>
                            </div>
                            
                            <div class="summary-box">
                                <h4 style="margin: 0; padding-bottom: 5px; border-bottom: 1px solid var(--color-primary); color: var(--color-secondary); font-size: 1.2em; font-weight: bold;">‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô (Summary)</h4>
                                <p style="font-size: 1.1em; margin: 10px 0 0 0; line-height: 1.5;">${data.summary}</p>
                            </div>
                            
                            <div class="main-cols">
                                <div class="left-col">
                                    <h4 class="cv-section">‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô/‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô üíº</h4>
                                    ${experienceHtml}

                                    <h4 class="cv-section">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ üéì</h4>
                                    ${educationContent}

                                    <h4 class="cv-section">‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå/‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á üöÄ</h4>
                                    <ul style="font-size: 1em; margin-top: 5px; padding-left: 20px; list-style-type: square;">
                                        ${projectsHtml}
                                        <li><strong>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°:</strong> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏ä‡∏°‡∏£‡∏°‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå (2565-2567)</li>
                                    </ul>
                                </div>
                                
                                <div class="right-col">
                                    <h4 class="cv-section" style="color: var(--color-primary);">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ üìû</h4>
                                    <div style="font-size: 1.05em; line-height: 1.4;">${contactContentWithIcons}</div>

                                    <h4 class="cv-section" style="color: var(--color-primary);">Technical Skills üíª</h4>
                                    <div style="margin-top: 5px; line-height: 1.5;">${renderSkills(data.technical_skills)}</div>

                                    <h4 class="cv-section" style="color: var(--color-primary);">Soft Skills üßë‚Äçü§ù‚Äçüßë</h4>
                                    <div style="margin-top: 5px; line-height: 1.5;">${renderSkills(data.soft_skills)}</div>
                                    
                                    <h4 class="cv-section" style="color: var(--color-primary);">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á</h4>
                                    <p style="font-size: 1em; margin-bottom: 0;">${data.reference}</p>
                                </div>
                            </div>
                        </div>
                    `;
                } 
                
                // 3. MINIMALIST-FOCUS (100%) - FIXED
                else if (templateId === 'minimalist-focus') {
                    return `
                        <div class="cv-minimalist-focus cv-section">
                            <div class="header">
                                <div style="width: 110px; height: 110px; border-radius: 50%; background-color: var(--color-light-bg); margin: 0 auto 8px auto; border: 3px solid var(--color-primary); background-image: url('${data.profile_img}'); background-size: cover; background-position: center;">
                                </div>
                                <h1>${data.name_th}</h1>
                                <h2>${data.job_title}</h2>
                            </div>
                            
                            <h4 class="cv-section">‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô üåü</h4>
                            <p style="font-size: 1em; margin: 5px 0 15px 0; line-height: 1.4;">${data.summary}</p>

                            <h4 class="cv-section">‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô/‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô üíº</h4>
                            ${experienceHtml}

                            <h4 class="cv-section">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ üéì</h4>
                            ${educationContent}

                            <h4 class="cv-section">‡∏ó‡∏±‡∏Å‡∏©‡∏∞ üõ†Ô∏è</h4>
                            <div style="display: flex; gap: 30px; margin-top: 8px;">
                                <div style="width: 50%;">
                                    <p style="font-weight: bold; margin-bottom: 5px; color: var(--color-secondary);">Technical Skills:</p>
                                    <p style="font-size: 0.95em; line-height: 1.3;">${data.technical_skills.map(s => `‚Ä¢ ${s}`).join('<br>')}</p>
                                </div>
                                <div style="width: 50%;">
                                    <p style="font-weight: bold; margin-bottom: 5px; color: var(--color-secondary);">Soft Skills:</p>
                                    <p style="font-size: 0.95em; line-height: 1.3;">${data.soft_skills.map(s => `‚Ä¢ ${s}`).join('<br>')}</p>
                                    <p style="font-weight: bold; margin-top: 15px; margin-bottom: 5px; color: var(--color-secondary);">‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÄ‡∏î‡πà‡∏ô:</p>
                                    <ul style="list-style: none; padding-left: 0; margin: 0; font-size: 0.95em;">${projectsHtml}</ul>
                                </div>
                            </div>
                            
                            <div class="footer-contact">
                                <p style="margin-bottom: 8px; font-weight: bold; color: var(--color-primary); font-size: 1em;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ | ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á</p>
                                <div style="display: flex; justify-content: space-around; flex-wrap: wrap; font-size: 0.95em; padding: 5px 0;">
                                    <span><span style="color:var(--color-primary);">&#9742;</span> **‡πÇ‡∏ó‡∏£:** ${data.phone}</span>
                                    <span><span style="color:var(--color-primary);">&#9993;</span> **‡∏≠‡∏µ‡πÄ‡∏°‡∏•:** ${data.email}</span>
                                    <span><span style="color:var(--color-primary);">&#128187;</span> **‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå:** <a href="${data.portfolio_link}" style="color: var(--color-text);">[Link]</a></span>
                                </div>
                                <p style="font-size: 0.9em; margin-top: 8px;">**‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á:** ${data.reference}</p>
                            </div>
                        </div>
                    `;
                }
            }

            // Event Listeners (Preview and Select)
            previewButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const templateId = e.target.dataset.template;
                    const cvHtml = generateCVHtml(templateId, data);
                    cvPreviewArea.innerHTML = cvHtml;
                    modal.style.display = 'block';
                });
            });

            selectButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const templateId = e.target.dataset.template;
                    alert(`‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï: ${templateId}\n(‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå CV ‡∏Ç‡∏ô‡∏≤‡∏î A4 ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)`);
                });
            });

            closeBtn.addEventListener('click', () => { modal.style.display = 'none'; });

            window.addEventListener('click', (e) => {
                if (e.target === modal) { modal.style.display = 'none'; }
            });
        });
    </script>
</body>
</html>